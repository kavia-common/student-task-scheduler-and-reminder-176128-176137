{"is_source_file": true, "format": "Python", "description": "This is a Python source file implementing a Pomodoro timer with session tracking, including configuration, state management, background ticking, and session logging, for a Streamlit web application.", "external_files": ["db", ".utils"], "external_methods": ["db.get_cursor", "toast_info", "toast_success", "toast_warning", "notify_placeholder"], "published": ["start_timer", "pause_timer", "reset_timer", "apply_config", "switch_mode", "get_config_and_state", "format_time_left", "list_recent_sessions"], "classes": [{"name": "PomodoroConfig", "description": "Configuration data for Pomodoro sessions, including focus and break durations."}, {"name": "PomodoroState", "description": "Runtime state of the Pomodoro timer, including mode, timing, cycle count, and session tracking."}], "methods": [{"name": "Tuple[PomodoroConfig,PomodoroState] _ensure_session_state(config: Optional[PomodoroConfig] = None)", "description": "Initialize or retrieve the Pomodoro configuration and state stored in Streamlit's session state.", "scope": "", "scopeKind": ""}, {"name": "None _persist_session(task_id: Optional[int], started_at: datetime, ended_at: datetime, duration_minutes: int, notes: str = \"\")", "description": "Log a completed Pomodoro session or break into the database.", "scope": "", "scopeKind": ""}, {"name": "None _transition_to_next(cfg: PomodoroConfig, state: PomodoroState)", "description": "Advance the timer to the next mode (focus, short break, long break) and notify the user.", "scope": "", "scopeKind": ""}, {"name": "None _complete_current_interval_and_log(state: PomodoroState)", "description": "Log the current interval (if completed) to the database.", "scope": "", "scopeKind": ""}, {"name": "None _start_new_interval_clock(state: PomodoroState)", "description": "Mark the start time of a new interval for logging.", "scope": "", "scopeKind": ""}, {"name": "None _tick_once()", "description": "Perform a single tick of the timer, updating state and handling transition on expiry.", "scope": "", "scopeKind": ""}, {"name": "None start_ticker_once()", "description": "Start a background thread that ticks periodically, ensuring only one thread runs.", "scope": "", "scopeKind": ""}, {"name": "None stop_ticker()", "description": "Stop the background ticking thread.", "scope": "", "scopeKind": ""}, {"name": "None start_timer(bound_task_id: Optional[int] = None)", "description": "Begin or resume the Pomodoro timer, optionally binding it to a task.", "scope": "", "scopeKind": ""}, {"name": "None pause_timer()", "description": "Pause the Pomodoro timer without resetting remaining time.", "scope": "", "scopeKind": ""}, {"name": "None reset_timer()", "description": "Reset the timer to the start of the current mode while logging a partial session if applicable.", "scope": "", "scopeKind": ""}, {"name": "None apply_config(focus: int, short: int, long: int, interval: int)", "description": "Update Pomodoro configuration parameters and reset times if timer is not running.", "scope": "", "scopeKind": ""}, {"name": "None switch_mode(new_mode: str)", "description": "Change the current mode (focus/break) and reset timer accordingly, optionally logging partial intervals.", "scope": "", "scopeKind": ""}, {"name": "Tuple[PomodoroConfig,PomodoroState] get_config_and_state()", "description": "Retrieve the current configuration and state objects.", "scope": "", "scopeKind": ""}, {"name": "str format_time_left(seconds: int)", "description": "Format remaining seconds into MM:SS string.", "scope": "", "scopeKind": ""}, {"name": "List[Dict[str,Any]] list_recent_sessions(limit: int = 20)", "description": "Fetch recent session logs from the database for display.", "scope": "", "scopeKind": ""}, {"name": "datetime _now()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _ticker_loop()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["db.get_cursor", "toast_info", "toast_success", "toast_warning", "notify_placeholder", "datetime.now", "st.session_state.__getitem__", "st.session_state.__setitem__", "cur.execute", "threading.Thread", "threading.Lock", "threading.Event", "time.sleep"], "search-terms": ["PomodoroConfig", "PomodoroState", "session logging", "background ticker", "mode switching", "session persistence", "timer control", "streamlit app", "task binding"], "state": 2, "file_id": 12, "knowledge_revision": 40, "git_revision": "c6106feab966ba8fa55b33e702297261874401b5", "revision_history": [{"38": ""}, {"40": "c6106feab966ba8fa55b33e702297261874401b5"}], "ctags": [{"_type": "tag", "name": "PomodoroConfig", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^class PomodoroConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PomodoroState", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^class PomodoroState:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_complete_current_interval_and_log", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _complete_current_interval_and_log(state: PomodoroState) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(state: PomodoroState)"}, {"_type": "tag", "name": "_ensure_session_state", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _ensure_session_state(config: Optional[PomodoroConfig] = None) -> Tuple[PomodoroConfig, Pomo/", "language": "Python", "typeref": "typename:Tuple[PomodoroConfig,PomodoroState]", "kind": "function", "signature": "(config: Optional[PomodoroConfig] = None)"}, {"_type": "tag", "name": "_now", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _now() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_persist_session", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _persist_session(task_id: Optional[int], started_at: datetime, ended_at: datetime, duration_/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(task_id: Optional[int], started_at: datetime, ended_at: datetime, duration_minutes: int, notes: str = \"\")"}, {"_type": "tag", "name": "_start_new_interval_clock", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _start_new_interval_clock(state: PomodoroState) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(state: PomodoroState)"}, {"_type": "tag", "name": "_tick_once", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _tick_once() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_ticker_lock", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^_ticker_lock = threading.Lock()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_ticker_loop", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _ticker_loop() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_ticker_stop", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^_ticker_stop = threading.Event()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_ticker_thread", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^_ticker_thread: Optional[threading.Thread] = None$/", "language": "Python", "typeref": "typename:Optional[threading.Thread]", "kind": "variable"}, {"_type": "tag", "name": "_transition_to_next", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def _transition_to_next(cfg: PomodoroConfig, state: PomodoroState) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(cfg: PomodoroConfig, state: PomodoroState)"}, {"_type": "tag", "name": "apply_config", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def apply_config(focus: int, short: int, long: int, interval: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(focus: int, short: int, long: int, interval: int)"}, {"_type": "tag", "name": "bound_task_id", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    bound_task_id: Optional[int] = None$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "current_session_start", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    current_session_start: Optional[datetime] = None$/", "language": "Python", "typeref": "typename:Optional[datetime]", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "cycle_count", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    cycle_count: int = 0  # completed focus sessions within current set$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "focus_minutes", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    focus_minutes: int = 25$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroConfig", "scopeKind": "class"}, {"_type": "tag", "name": "format_time_left", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def format_time_left(seconds: int) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(seconds: int)"}, {"_type": "tag", "name": "get_config_and_state", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def get_config_and_state() -> Tuple[PomodoroConfig, PomodoroState]:$/", "language": "Python", "typeref": "typename:Tuple[PomodoroConfig,PomodoroState]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "is_running", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    is_running: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "list_recent_sessions", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def list_recent_sessions(limit: int = 20) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "function", "signature": "(limit: int = 20)"}, {"_type": "tag", "name": "long_break_interval", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    long_break_interval: int = 4  # after N focus sessions, take a long break$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroConfig", "scopeKind": "class"}, {"_type": "tag", "name": "long_break_minutes", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    long_break_minutes: int = 15$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroConfig", "scopeKind": "class"}, {"_type": "tag", "name": "mode", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    mode: str = \"focus\"  # focus | short_break | long_break$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "pause_timer", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def pause_timer() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "reset_timer", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def reset_timer() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "short_break_minutes", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    short_break_minutes: int = 5$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroConfig", "scopeKind": "class"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^import streamlit as st$/", "language": "Python", "kind": "namespace", "nameref": "module:streamlit"}, {"_type": "tag", "name": "start_ticker_once", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def start_ticker_once() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "start_timer", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def start_timer(bound_task_id: Optional[int] = None) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(bound_task_id: Optional[int] = None)"}, {"_type": "tag", "name": "stop_ticker", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def stop_ticker() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "switch_mode", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^def switch_mode(new_mode: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(new_mode: str)"}, {"_type": "tag", "name": "ticker_id", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    ticker_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "time_left_sec", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    time_left_sec: int = 25 * 60$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}, {"_type": "tag", "name": "total_focus_completed", "path": "/home/kavia/workspace/code-generation/student-task-scheduler-and-reminder-176128-176137/task_scheduler_backend/streamlit_app/pomodoro.py", "pattern": "/^    total_focus_completed: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PomodoroState", "scopeKind": "class"}], "hash": "1238981a4e28ad2a008060e99be16c6a", "format-version": 4, "code-base-name": "task_scheduler_backend", "filename": "task_scheduler_backend/streamlit_app/pomodoro.py", "fields": [{"name": "_ticker_lock = threading.Lock()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_ticker_stop = threading.Event()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[threading.Thread] _ticker_thread", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[int] bound_task_id", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[datetime] current_session_start", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int cycle_count", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int focus_minutes", "scope": "PomodoroConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_running", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int long_break_interval", "scope": "PomodoroConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "int long_break_minutes", "scope": "PomodoroConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "str mode", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int short_break_minutes", "scope": "PomodoroConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] ticker_id", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int time_left_sec", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}, {"name": "int total_focus_completed", "scope": "PomodoroState", "scopeKind": "class", "description": "unavailable"}]}